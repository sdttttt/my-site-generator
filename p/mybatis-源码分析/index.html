<!DOCTYPE html>
<html lang="zh-cn"><head>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='æœ¬æ–‡è®©ä½ çŸ¥é“iBatisæ˜¯æ€ä¹ˆå·¥ä½œçš„, ä»¥åŠä¸€äº›ä½ å¯èƒ½ä¸çŸ¥é“çš„æ‰§è¡Œç»†èŠ‚.'><title>MyBatis æºç åˆ†æ</title>
    
    <link rel='canonical' href='https://sdttttt.github.io/p/mybatis-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/'>

<link rel="stylesheet" href="/scss/style.min.css"><meta property='og:title' content='MyBatis æºç åˆ†æ'>
<meta property='og:description' content='æœ¬æ–‡è®©ä½ çŸ¥é“iBatisæ˜¯æ€ä¹ˆå·¥ä½œçš„, ä»¥åŠä¸€äº›ä½ å¯èƒ½ä¸çŸ¥é“çš„æ‰§è¡Œç»†èŠ‚.'>
<meta property='og:url' content='https://sdttttt.github.io/p/mybatis-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/'>
<meta property='og:site_name' content='SDTTTTT&#39;s Smelly fish Rotten shrimp ğŸ““'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Java' /><meta property='article:published_time' content='2020-09-10T22:15:42&#43;08:00'/><meta property='article:modified_time' content='2020-09-10T22:15:42&#43;08:00'/>
<meta name="twitter:title" content="MyBatis æºç åˆ†æ">
<meta name="twitter:description" content="æœ¬æ–‡è®©ä½ çŸ¥é“iBatisæ˜¯æ€ä¹ˆå·¥ä½œçš„, ä»¥åŠä¸€äº›ä½ å¯èƒ½ä¸çŸ¥é“çš„æ‰§è¡Œç»†èŠ‚."></head><body class="">
        <div class="container flex on-phone--column align-items--flex-start extended article-page with-toolbar">
            <aside class="sidebar left-sidebar sticky">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="åˆ‡æ¢èœå•">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header class="site-info">
        
            <figure class="site-avatar">
                

                
                    
                    <img src="/img/wolaopo_huaa9cfa37fb7c13295de7156385ad8dbe_251770_300x300_resize_box_2.png" width="300"
                        height="300" class="site-logo" loading="lazy" alt="Avatar">
                

                <span class="emoji">ğŸ¥</span>
            </figure>
        
        <h1 class="site-name"><a href="https://sdttttt.github.io/">SDTTTTT&#39;s Smelly fish Rotten shrimp ğŸ““</a></h1>
        <h2 class="site-description">Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2>
    </header>

    <ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='https://sdttttt.github.io/'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='https://sdttttt.github.io/about'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='https://sdttttt.github.io/archives'>
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
    </ol>
</aside>
            <main class="main full-width">
    <div id="article-toolbar">
        <a href="https://sdttttt.github.io/" class="back-home">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="15 6 9 12 15 18" />
</svg>



            <span>Back</span>
        </a>
    </div>

    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    

    <h2 class="article-title">
        <a href="https://sdttttt.github.io/p/mybatis-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">MyBatis æºç åˆ†æ</a>
    </h2>

    
    <h3 class="article-subtitle">
        æœ¬æ–‡è®©ä½ çŸ¥é“iBatisæ˜¯æ€ä¹ˆå·¥ä½œçš„, ä»¥åŠä¸€äº›ä½ å¯èƒ½ä¸çŸ¥é“çš„æ‰§è¡Œç»†èŠ‚.
    </h3>
    <footer class="article-time">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



        <time class="article-time--published">Sep 10, 2020</time>
    </footer></div>
</header>

    <section class="article-content">
    <p>å…¶å®å¾ˆæ—©å°±æƒ³å†™ä¸€ç¯‡ iBatis çš„æºç åˆ†æäº†, ä¸è¿‡æœ‰æ®µæ—¶é—´å»å­¦ä¹  Go äº†, Java å°±æ”¾ä¸‹äº†, æœ€è¿‘
é‡æ–°æ¡èµ· Java å°±æŠŠä»¥å‰æ²¡å¡«çš„å‘,å¡«ä¸€ä¸‹.</p>
<h1 id="init">Init</h1>
<p>ç°åœ¨å¼€å§‹æ­£ç‰‡.</p>
<p>é¦–å…ˆæ˜¯ iBatis çš„åˆå§‹åŒ–å·¥ä½œ.æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä»£ç :</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="c1">// `BlogDataSourceFactory`çš„ä¸»è¦ä½œç”¨: é€šè¿‡ä½ çš„é…ç½®æ–‡ä»¶, åˆå§‹åŒ–ä¸€ä¸ªDataSource
</span><span class="c1"></span><span class="n">DataSource</span> <span class="n">dataSource</span> <span class="o">=</span> <span class="n">BlogDataSourceFactory</span><span class="o">.</span><span class="na">getBlogDataSource</span><span class="o">();</span>
<span class="c1">// JdbcTransactionFactoryä¸€ä¸ªNewå°±èƒ½å¾—åˆ°, æ²¡ä»€ä¹ˆä¾èµ–æ¡ä»¶
</span><span class="c1"></span><span class="n">TransactionFactory</span> <span class="n">transactionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JdbcTransactionFactory</span><span class="o">();</span>
<span class="c1">// Environmentè¦ä½ äº¤å‡ºæ•°æ®æºå’Œäº‹åŠ¡å·¥å‚è¿˜æœ‰ä½ çš„ç¯å¢ƒæ˜¯å¼€å‘è¿˜æ˜¯ç”Ÿäº§
</span><span class="c1"></span><span class="n">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Environment</span><span class="o">(</span><span class="s">&#34;development&#34;</span><span class="o">,</span> <span class="n">transactionFactory</span><span class="o">,</span> <span class="n">dataSource</span><span class="o">);</span>
<span class="c1">// Configurationæœ‰åŸºæœ¬ä¸Šä½ æ‰€æœ‰çš„é…ç½®
</span><span class="c1"></span><span class="n">Configuration</span> <span class="n">configuration</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Configuration</span><span class="o">(</span><span class="n">environment</span><span class="o">);</span>
<span class="c1">// æ·»åŠ ä½ çš„mapperåˆ°é…ç½®åˆ—è¡¨ä¸­, ç­‰ä¼šæˆ‘ä»¬å»åˆ†æå®ƒ
</span><span class="c1"></span><span class="n">configuration</span><span class="o">.</span><span class="na">addMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
<span class="c1">// é€šè¿‡ä½ çš„é…ç½®ç±»,è®©æˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªSqlSessionFactory! æˆ‘ä»¬ç»ˆäºè¿›å…¥æ­£é¢˜äº†!!
</span><span class="c1">// å¯èƒ½ä½ è§‰å¾—å¾ˆå¿«... å…¶å®æœ¬äººåœ¨è¿™é‡Œé¢åˆ†æè¿˜æ˜¯èŠ±äº†å¾ˆé•¿æ—¶é—´
</span><span class="c1"></span><span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">configuration</span><span class="o">);</span>
</code></pre></div><p>å¥½, ä¸Šæ–‡æœ‰è¯´<code>configuration.addMapper(BlogMapper.class)</code>è¿™ä¸ªæ–¹æ³•, ç°åœ¨æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹å®ƒ.</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">
    <span class="c1">// è¿™ä¸ªæ˜¯Configurationä¸­çš„æ–¹æ³•, å®ƒå®é™…ä¸Šæ˜¯å§”æ‰˜mapperRegistryå»æ‰§è¡Œ
</span><span class="c1"></span>    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">addMapper</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mapperRegistry</span><span class="o">.</span><span class="na">addMapper</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kt">void</span> <span class="nf">addMapper</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//mapperå¿…é¡»æ˜¯æ¥å£
</span><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="n">type</span><span class="o">.</span><span class="na">isInterface</span><span class="o">())</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">hasMapper</span><span class="o">(</span><span class="n">type</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">//å¦‚æœé‡å¤æ·»åŠ äº†ï¼ŒæŠ¥é”™
</span><span class="c1"></span>            <span class="k">throw</span> <span class="k">new</span> <span class="n">BindingException</span><span class="o">(</span><span class="s">&#34;Type &#34;</span> <span class="o">+</span> <span class="n">type</span> <span class="o">+</span> <span class="s">&#34; is already known to the MapperRegistry.&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="kt">boolean</span> <span class="n">loadCompleted</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// åŠ å…¥ä¸€ä¸ªMapperçš„ä»£ç†ç”Ÿäº§å·¥å‚
</span><span class="c1"></span>            <span class="n">knownMappers</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">type</span><span class="o">,</span> <span class="k">new</span> <span class="n">MapperProxyFactory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;(</span><span class="n">type</span><span class="o">));</span>
            <span class="c1">// It&#39;s important that the type is added before the parser is run
</span><span class="c1"></span>            <span class="c1">// otherwise the binding may automatically be attempted by the
</span><span class="c1"></span>            <span class="c1">// mapper parser. If the type is already known, it won&#39;t try.
</span><span class="c1"></span>            <span class="c1">// è¿™ä¸ªæ˜¯é€šè¿‡æ³¨è§£æ¥æ„å»ºMapper, æš‚æ—¶ä¸çœ‹
</span><span class="c1"></span>            <span class="n">MapperAnnotationBuilder</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MapperAnnotationBuilder</span><span class="o">(</span><span class="n">config</span><span class="o">,</span> <span class="n">type</span><span class="o">);</span>
            <span class="n">parser</span><span class="o">.</span><span class="na">parse</span><span class="o">();</span>
            <span class="n">loadCompleted</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="c1">//å¦‚æœåŠ è½½è¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸éœ€è¦å†å°†è¿™ä¸ªmapperä»mybatisä¸­åˆ é™¤
</span><span class="c1"></span>            <span class="k">if</span> <span class="o">(!</span><span class="n">loadCompleted</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">knownMappers</span><span class="o">.</span><span class="na">remove</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div><h1 id="sqlsessionfactory">SqlSessionFactory</h1>
<p>æ—¢ç„¶æœ‰äº† SqlSessionFactoryï¼Œé¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸­è·å¾— SqlSession çš„å®ä¾‹ã€‚
SqlSession æä¾›äº†åœ¨æ•°æ®åº“æ‰§è¡Œ SQL å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰æ–¹æ³•ã€‚
ä½ å¯ä»¥é€šè¿‡ SqlSession å®ä¾‹æ¥ç›´æ¥æ‰§è¡Œå·²æ˜ å°„çš„ SQL è¯­å¥ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="k">try</span> <span class="o">(</span><span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">())</span> <span class="o">{</span>
  <span class="n">BlogMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="n">Blog</span> <span class="n">blog</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectBlog</span><span class="o">(</span><span class="n">101</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><p>å¥½! æˆ‘ä»¬å¿«è¿›åˆ°<del>æ›¹ä¸•</del>sqlSessionFactory.openSession()</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">    <span class="kd">public</span> <span class="n">SqlSession</span> <span class="nf">openSession</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">openSessionFromDataSource</span><span class="o">(</span><span class="n">configuration</span><span class="o">.</span><span class="na">getDefaultExecutorType</span><span class="o">(),</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="n">SqlSession</span> <span class="nf">openSessionFromDataSource</span><span class="o">(</span><span class="n">ExecutorType</span> <span class="n">execType</span><span class="o">,</span> <span class="n">TransactionIsolationLevel</span> <span class="n">level</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">autoCommit</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// Transactionäº‹åŠ¡ï¼ŒåŒ…è£…äº†ä¸€ä¸ªConnection, åŒ…å«commit,rollback,closeæ–¹æ³•
</span><span class="c1"></span>    <span class="n">Transaction</span> <span class="n">tx</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">// è¿˜è®°å¾—ä¹ˆ, environmenté‡Œå°è£…äº†æˆ‘ä»¬çš„æ•°æ®æº;äº‹åŠ¡å·¥å‚;è¿˜æœ‰ç¯å¢ƒ
</span><span class="c1"></span>      <span class="kd">final</span> <span class="n">Environment</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">();</span>
      <span class="c1">// å¾—åˆ°ä¸€ä¸ªäº‹åŠ¡å·¥å‚, å¦‚æœenvæˆ–è€…envé‡Œçš„äº‹åŠ¡å·¥å‚æ˜¯ç©ºçš„å°±è¿”å›ä¸€ä¸ªæ‰˜ç®¡äº‹åŠ¡å·¥å‚
</span><span class="c1"></span>      <span class="c1">// æ‰˜ç®¡äº‹åŠ¡å·¥å‚çš„ç‰¹ç‚¹å°±æ˜¯æ¯æ¬¡æ‰§è¡Œå®ŒæˆSQLéƒ½ä¼šå…³é—­è¿æ¥, å¦‚æœä½ ä¸å¸Œæœ›å…³é—­è¿æ¥è¦åœ¨é…ç½®æ–‡ä»¶é‡Œè®¾ç½®å®ƒ
</span><span class="c1"></span>      <span class="kd">final</span> <span class="n">TransactionFactory</span> <span class="n">transactionFactory</span> <span class="o">=</span> <span class="n">getTransactionFactoryFromEnvironment</span><span class="o">(</span><span class="n">environment</span><span class="o">);</span>
      <span class="c1">//é€šè¿‡äº‹åŠ¡å·¥å‚æ¥äº§ç”Ÿä¸€ä¸ªäº‹åŠ¡
</span><span class="c1"></span>      <span class="n">tx</span> <span class="o">=</span> <span class="n">transactionFactory</span><span class="o">.</span><span class="na">newTransaction</span><span class="o">(</span><span class="n">environment</span><span class="o">.</span><span class="na">getDataSource</span><span class="o">(),</span> <span class="n">level</span><span class="o">,</span> <span class="n">autoCommit</span><span class="o">);</span>
      <span class="c1">//ç”Ÿæˆä¸€ä¸ªæ‰§è¡Œå™¨(äº‹åŠ¡åŒ…å«åœ¨æ‰§è¡Œå™¨é‡Œ)
</span><span class="c1"></span>      <span class="kd">final</span> <span class="n">Executor</span> <span class="n">executor</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="na">newExecutor</span><span class="o">(</span><span class="n">tx</span><span class="o">,</span> <span class="n">execType</span><span class="o">);</span>
      <span class="c1">//ç„¶åäº§ç”Ÿä¸€ä¸ªDefaultSqlSession
</span><span class="c1"></span>      <span class="k">return</span> <span class="k">new</span> <span class="n">DefaultSqlSession</span><span class="o">(</span><span class="n">configuration</span><span class="o">,</span> <span class="n">executor</span><span class="o">,</span> <span class="n">autoCommit</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">//å¦‚æœæ‰“å¼€äº‹åŠ¡å‡ºé”™ï¼Œåˆ™å…³é—­å®ƒ
</span><span class="c1"></span>      <span class="n">closeTransaction</span><span class="o">(</span><span class="n">tx</span><span class="o">);</span> <span class="c1">// may have fetched a connection so lets call close()
</span><span class="c1"></span>      <span class="k">throw</span> <span class="n">ExceptionFactory</span><span class="o">.</span><span class="na">wrapException</span><span class="o">(</span><span class="s">&#34;Error opening session.  Cause: &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="c1">//æœ€åæ¸…ç©ºé”™è¯¯ä¸Šä¸‹æ–‡
</span><span class="c1"></span>      <span class="n">ErrorContext</span><span class="o">.</span><span class="na">instance</span><span class="o">().</span><span class="na">reset</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ª<code>SqlSession</code>.</p>
<blockquote>
<p>2020.10.12 ç»§ç»­æ›´æ–°</p>
</blockquote>
<p>æœ‰äº†<code>SqlSession</code>ä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ“ä½œæ•°æ®åº“äº†ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹MyBatisæ˜¯æ€ä¹ˆå®ç°<code>session.selectOne(&quot;org.mybatis.example.BlogMapper.selectBlog&quot;, 101);</code>çš„ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">selectOne</span><span class="o">(</span><span class="n">String</span> <span class="n">statement</span><span class="o">,</span> <span class="n">Object</span> <span class="n">parameter</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Popular vote was to return null on 0 results and throw exception on too many.
</span><span class="c1"></span>    <span class="c1">//è½¬è€Œå»è°ƒç”¨selectList,å¾ˆç®€å•çš„ï¼Œå¦‚æœå¾—åˆ°0æ¡åˆ™è¿”å›nullï¼Œå¾—åˆ°1æ¡åˆ™è¿”å›1æ¡ï¼Œå¾—åˆ°å¤šæ¡æŠ¥TooManyResultsExceptioné”™
</span><span class="c1"></span>    <span class="c1">// ç‰¹åˆ«éœ€è¦ä¸»è¦çš„æ˜¯å½“æ²¡æœ‰æŸ¥è¯¢åˆ°ç»“æœçš„æ—¶å€™å°±ä¼šè¿”å›nullã€‚å› æ­¤ä¸€èˆ¬å»ºè®®åœ¨mapperä¸­ç¼–å†™resultTypeçš„æ—¶å€™ä½¿ç”¨åŒ…è£…ç±»å‹
</span><span class="c1"></span>    <span class="c1">//è€Œä¸æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ¯”å¦‚æ¨èä½¿ç”¨Integerè€Œä¸æ˜¯intã€‚è¿™æ ·å°±å¯ä»¥é¿å…NPE
</span><span class="c1"></span>    <span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">this</span><span class="o">.&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="n">selectList</span><span class="o">(</span><span class="n">statement</span><span class="o">,</span> <span class="n">parameter</span><span class="o">);</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">return</span> <span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">0</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">TooManyResultsException</span><span class="o">(</span><span class="s">&#34;Expected one result (or null) to be returned by selectOne(), but found: &#34;</span> <span class="o">+</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
    <span class="o">}</span>
  <span class="o">}</span>

  <span class="c1">// emmï¼Œè¿™é‡Œå…¶å®å•¥éƒ½æ²¡æœ‰ï¼Œæˆ‘ä»¬å»SelectListçœ‹çœ‹ã€‚
</span><span class="c1"></span>
  <span class="c1">// åœ¨ä¸‹æ¥è§£é‡Šä¸€ä¸‹è¿™ä¸‰ä¸ªå‚æ•°ï¼š
</span><span class="c1"></span>  <span class="c1">// statement æ˜ å°„è¯­å¥çš„ä½ç½®ï¼Œæ¯”å¦‚&#34;org.mybatis.example.BlogMapper.selectBlog&#34;
</span><span class="c1"></span>  <span class="c1">// parameter SQLè¯­å¥ä¸­çš„å‚æ•°
</span><span class="c1"></span>  <span class="c1">// RowBounds åˆ†é¡µé™åˆ¶ï¼Œç›¸å½“äºSQLä¸­çš„limit. 
</span><span class="c1"></span>  <span class="kd">public</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">selectList</span><span class="o">(</span><span class="n">String</span> <span class="n">statement</span><span class="o">,</span> <span class="n">Object</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">RowBounds</span> <span class="n">rowBounds</span><span class="o">)</span> <span class="o">{</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">//æ ¹æ®statement idæ‰¾åˆ°å¯¹åº”çš„MappedStatement
</span><span class="c1"></span>      <span class="n">MappedStatement</span> <span class="n">ms</span> <span class="o">=</span> <span class="n">configuration</span><span class="o">.</span><span class="na">getMappedStatement</span><span class="o">(</span><span class="n">statement</span><span class="o">);</span>
      <span class="c1">//è½¬è€Œç”¨æ‰§è¡Œå™¨æ¥æŸ¥è¯¢ç»“æœ,æ³¨æ„è¿™é‡Œä¼ å…¥çš„ResultHandleræ˜¯null
</span><span class="c1"></span>      <span class="c1">// wrapCollectionï¼šå¦‚æœå‚æ•°æ˜¯Collectionç±»å‹ï¼Œè½¬æ¢æˆMapï¼Œkeyä¸ºparameterçš„type.
</span><span class="c1"></span>      <span class="k">return</span> <span class="n">executor</span><span class="o">.</span><span class="na">query</span><span class="o">(</span><span class="n">ms</span><span class="o">,</span> <span class="n">wrapCollection</span><span class="o">(</span><span class="n">parameter</span><span class="o">),</span> <span class="n">rowBounds</span><span class="o">,</span> <span class="n">Executor</span><span class="o">.</span><span class="na">NO_RESULT_HANDLER</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        
      <span class="k">throw</span> <span class="n">ExceptionFactory</span><span class="o">.</span><span class="na">wrapException</span><span class="o">(</span><span class="s">&#34;Error querying database.  Cause: &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">ErrorContext</span><span class="o">.</span><span class="na">instance</span><span class="o">().</span><span class="na">reset</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>


  <span class="c1">// æ¥ä¸‹æ¥æ˜¯æ‰§è¡Œå™¨çš„éƒ¨åˆ†
</span><span class="c1"></span>  <span class="kd">public</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">query</span><span class="o">(</span><span class="n">MappedStatement</span> <span class="n">ms</span><span class="o">,</span> <span class="n">Object</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">RowBounds</span> <span class="n">rowBounds</span><span class="o">,</span> <span class="n">ResultHandler</span> <span class="n">resultHandler</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="c1">//å¾—åˆ°ç»‘å®šsqlï¼Œå°±æ˜¯å°†å‚æ•°æ’å…¥æ˜ å°„è¯­å¥é‡Œï¼Œè·å¾—å®Œæ•´çš„SQL
</span><span class="c1"></span>    <span class="n">BoundSql</span> <span class="n">boundSql</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="na">getBoundSql</span><span class="o">(</span><span class="n">parameter</span><span class="o">);</span>
    <span class="c1">//åˆ›å»ºç¼“å­˜Key
</span><span class="c1"></span>    <span class="n">CacheKey</span> <span class="n">key</span> <span class="o">=</span> <span class="n">createCacheKey</span><span class="o">(</span><span class="n">ms</span><span class="o">,</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">rowBounds</span><span class="o">,</span> <span class="n">boundSql</span><span class="o">);</span>
    <span class="c1">//æŸ¥è¯¢
</span><span class="c1"></span>    <span class="k">return</span> <span class="n">query</span><span class="o">(</span><span class="n">ms</span><span class="o">,</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">rowBounds</span><span class="o">,</span> <span class="n">resultHandler</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">boundSql</span><span class="o">);</span>
 <span class="o">}</span>

 <span class="c1">// æ‰§è¡ŒæŸ¥è¯¢
</span><span class="c1"></span>  <span class="kd">public</span> <span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="nf">query</span><span class="o">(</span><span class="n">MappedStatement</span> <span class="n">ms</span><span class="o">,</span> <span class="n">Object</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">RowBounds</span> <span class="n">rowBounds</span><span class="o">,</span> <span class="n">ResultHandler</span> <span class="n">resultHandler</span><span class="o">,</span> <span class="n">CacheKey</span> <span class="n">key</span><span class="o">,</span> <span class="n">BoundSql</span> <span class="n">boundSql</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">SQLException</span> <span class="o">{</span>
    <span class="c1">// ErrorContext æ˜¯æ¯ä¸ªçº¿ç¨‹å•ç‹¬ä½¿ç”¨çš„é”™è¯¯ä¸Šä¸‹æ–‡ï¼Œå®ƒæ˜¯ç”¨ThreadLocalåˆ¶ä½œçš„.
</span><span class="c1"></span>    <span class="n">ErrorContext</span><span class="o">.</span><span class="na">instance</span><span class="o">().</span><span class="na">resource</span><span class="o">(</span><span class="n">ms</span><span class="o">.</span><span class="na">getResource</span><span class="o">()).</span><span class="na">activity</span><span class="o">(</span><span class="s">&#34;executing a query&#34;</span><span class="o">).</span><span class="na">object</span><span class="o">(</span><span class="n">ms</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="c1">//å¦‚æœå·²ç»å…³é—­ï¼ŒæŠ¥é”™
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">closed</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">ExecutorException</span><span class="o">(</span><span class="s">&#34;Executor was closed.&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//å…ˆæ¸…å±€éƒ¨ç¼“å­˜ï¼Œå†æŸ¥è¯¢.ä½†ä»…æŸ¥è¯¢å †æ ˆä¸º0ï¼Œæ‰æ¸…ã€‚ä¸ºäº†å¤„ç†é€’å½’è°ƒç”¨
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">queryStack</span> <span class="o">==</span> <span class="n">0</span> <span class="o">&amp;&amp;</span> <span class="n">ms</span><span class="o">.</span><span class="na">isFlushCacheRequired</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">clearLocalCache</span><span class="o">();</span>
    <span class="o">}</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">//åŠ ä¸€,è¿™æ ·é€’å½’è°ƒç”¨åˆ°ä¸Šé¢çš„æ—¶å€™å°±ä¸ä¼šå†æ¸…å±€éƒ¨ç¼“å­˜äº†
</span><span class="c1"></span>      <span class="n">queryStack</span><span class="o">++;</span>
      <span class="c1">//å…ˆæ ¹æ®cachekeyä»localCacheå»æŸ¥
</span><span class="c1"></span>      <span class="n">list</span> <span class="o">=</span> <span class="n">resultHandler</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">E</span><span class="o">&gt;)</span> <span class="n">localCache</span><span class="o">.</span><span class="na">getObject</span><span class="o">(</span><span class="n">key</span><span class="o">)</span> <span class="o">:</span> <span class="kc">null</span><span class="o">;</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">list</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//è‹¥æŸ¥åˆ°localCacheç¼“å­˜ï¼Œå¤„ç†localOutputParameterCache
</span><span class="c1"></span>        <span class="n">handleLocallyCachedOutputParameters</span><span class="o">(</span><span class="n">ms</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">boundSql</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c1">//ä»æ•°æ®åº“æŸ¥
</span><span class="c1"></span>        <span class="n">list</span> <span class="o">=</span> <span class="n">queryFromDatabase</span><span class="o">(</span><span class="n">ms</span><span class="o">,</span> <span class="n">parameter</span><span class="o">,</span> <span class="n">rowBounds</span><span class="o">,</span> <span class="n">resultHandler</span><span class="o">,</span> <span class="n">key</span><span class="o">,</span> <span class="n">boundSql</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="c1">//æ¸…ç©ºå †æ ˆ
</span><span class="c1"></span>      <span class="n">queryStack</span><span class="o">--;</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">queryStack</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">//å»¶è¿ŸåŠ è½½é˜Ÿåˆ—ä¸­æ‰€æœ‰å…ƒç´ 
</span><span class="c1"></span>      <span class="k">for</span> <span class="o">(</span><span class="n">DeferredLoad</span> <span class="n">deferredLoad</span> <span class="o">:</span> <span class="n">deferredLoads</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">deferredLoad</span><span class="o">.</span><span class="na">load</span><span class="o">();</span>
      <span class="o">}</span>

      <span class="c1">// issue #601
</span><span class="c1"></span>      <span class="c1">//æ¸…ç©ºå»¶è¿ŸåŠ è½½é˜Ÿåˆ—
</span><span class="c1"></span>      <span class="n">deferredLoads</span><span class="o">.</span><span class="na">clear</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">configuration</span><span class="o">.</span><span class="na">getLocalCacheScope</span><span class="o">()</span> <span class="o">==</span> <span class="n">LocalCacheScope</span><span class="o">.</span><span class="na">STATEMENT</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// issue #482
</span><span class="c1"></span>    	<span class="c1">//å¦‚æœæ˜¯STATEMENTï¼Œæ¸…æœ¬åœ°ç¼“å­˜
</span><span class="c1"></span>        <span class="n">clearLocalCache</span><span class="o">();</span>
      <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
  <span class="o">}</span>
</code></pre></div><p>ä»¥ä¸Šæ˜¯<code>SqlSession.selectOne</code>çš„æµç¨‹ã€‚ç„¶è€Œå®é™…ä¸­æˆ‘ä»¬ç›´æ¥ä½¿ç”¨SqlSessionæ¥æ‰§è¡Œæ•°æ®åº“æ“ä½œçš„æƒ…å†µå¾ˆå°‘ã€‚</p>
<p>å¤§å¤šæ•°æƒ…å†µæˆ‘ä»¬ä¼šè¿™æ ·ä½¿ç”¨MyBatis:</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java"><span class="k">try</span> <span class="o">(</span><span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">())</span> <span class="o">{</span>
  <span class="n">BlogMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  <span class="n">Blog</span> <span class="n">blog</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectBlog</span><span class="o">(</span><span class="n">101</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></div><p>è¿™ä¸ªæ–¹æ³•çš„è¯¦ç»†è¿‡ç¨‹æˆ‘ä»¬ä½¿ç”¨MyBatisçš„å•å…ƒæµ‹è¯•æ¥æ¢ç´¢ã€‚</p>
<p>å•å…ƒæµ‹è¯•ä»£ç ï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="nd">@Test</span>
  <span class="kd">public</span> <span class="kt">void</span> <span class="nf">shouldSelectBlogWithPostsUsingSubSelect</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
    <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="n">BoundBlogMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BoundBlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
      <span class="n">Blog</span> <span class="n">b</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">selectBlogWithPostsUsingSubSelect</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
      <span class="n">assertEquals</span><span class="o">(</span><span class="n">1</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
      <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
      <span class="n">assertNotNull</span><span class="o">(</span><span class="n">b</span><span class="o">.</span><span class="na">getAuthor</span><span class="o">());</span>
      <span class="n">assertEquals</span><span class="o">(</span><span class="n">101</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">getAuthor</span><span class="o">().</span><span class="na">getId</span><span class="o">());</span>
      <span class="n">assertEquals</span><span class="o">(</span><span class="s">&#34;jim&#34;</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">getAuthor</span><span class="o">().</span><span class="na">getUsername</span><span class="o">());</span>
      <span class="n">assertEquals</span><span class="o">(</span><span class="s">&#34;********&#34;</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">getAuthor</span><span class="o">().</span><span class="na">getPassword</span><span class="o">());</span>
      <span class="n">assertEquals</span><span class="o">(</span><span class="n">2</span><span class="o">,</span> <span class="n">b</span><span class="o">.</span><span class="na">getPosts</span><span class="o">().</span><span class="na">size</span><span class="o">());</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
      <span class="n">session</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div><p>å¿«è¿›åˆ°<code>session.getMapper</code></p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="c1">//è¿”å›ä»£ç†ç±»
</span><span class="c1"></span>  <span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">getMapper</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">type</span><span class="o">,</span> <span class="n">SqlSession</span> <span class="n">sqlSession</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// ç›´æ¥å¾—åˆ°è¯¥ç±»å‹Mapperä»£ç†å·¥å‚
</span><span class="c1"></span>    <span class="kd">final</span> <span class="n">MapperProxyFactory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">mapperProxyFactory</span> <span class="o">=</span> <span class="o">(</span><span class="n">MapperProxyFactory</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;)</span> <span class="n">knownMappers</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">type</span><span class="o">);</span>
    <span class="c1">// æ²¡æœ‰å°±ç¦»è°±
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">mapperProxyFactory</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">BindingException</span><span class="o">(</span><span class="s">&#34;Type &#34;</span> <span class="o">+</span> <span class="n">type</span> <span class="o">+</span> <span class="s">&#34; is not known to the MapperRegistry.&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">try</span> <span class="o">{</span>
      <span class="c1">// é€šè¿‡å½“å‰Sessionç”Ÿäº§ä¸€ä¸ªä»£ç†
</span><span class="c1"></span>      <span class="k">return</span> <span class="n">mapperProxyFactory</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">);</span>
    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">BindingException</span><span class="o">(</span><span class="s">&#34;Error getting mapper instance. Cause: &#34;</span> <span class="o">+</span> <span class="n">e</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
    <span class="o">}</span>
  <span class="o">}</span>
</code></pre></div><p>å®é™…ä¸Šç”Ÿäº§Mapperçš„é€»è¾‘å¹¶ä¸å¤šã€‚</p>
<p>ä¸»è¦æ˜¯æ‰§è¡Œä»£ç†æ–¹æ³•æ—¶çš„åŠ¨ä½œã€‚</p>
<p>æ‰§è¡Œ<code>mapper.selectBlogWithPostsUsingSubSelect(1);</code>çš„é€»è¾‘å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="c1">// ç”±äºæ˜¯ä»£ç†ç”Ÿæˆçš„ï¼Œæ‰€ä»¥è°ƒç”¨æ–¹æ³•åä¼šè¿›å…¥ä¸€ä¸‹é€»è¾‘ï¼š
</span><span class="c1"></span>  <span class="nd">@Override</span>
  <span class="kd">public</span> <span class="n">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="n">Object</span> <span class="n">proxy</span><span class="o">,</span> <span class="n">Method</span> <span class="n">method</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Throwable</span> <span class="o">{</span>
    <span class="c1">// å¦‚æœè¿™ä¸ªæ–¹æ³•æ˜¯æ¥è‡ªObjectï¼Œå°±ç›´æ¥æ‰§è¡Œï¼Œç›´æ¥è¿”å›
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">Object</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getDeclaringClass</span><span class="o">()))</span> <span class="o">{</span>
      <span class="k">try</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Throwable</span> <span class="n">t</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">throw</span> <span class="n">ExceptionUtil</span><span class="o">.</span><span class="na">unwrapThrowable</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">}</span>
    
    <span class="c1">// å»ç¼“å­˜ä¸­æ‰¾MapperMethodï¼Œç¬¬ä¸€æ¬¡çš„è¯ä¼šnewä¸€ä¸ª
</span><span class="c1"></span>    <span class="kd">final</span> <span class="n">MapperMethod</span> <span class="n">mapperMethod</span> <span class="o">=</span> <span class="n">cachedMapperMethod</span><span class="o">(</span><span class="n">method</span><span class="o">);</span>
    <span class="c1">//æ‰§è¡Œæœ¬ä½“
</span><span class="c1"></span>    <span class="k">return</span> <span class="n">mapperMethod</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
  <span class="o">}</span>

</code></pre></div><p>ä¸‹é¢å°±æ˜¯æ•´ä¸ªä»£ç†çš„æ‰§è¡Œæ•°æ®åº“æ“ä½œçš„é€»è¾‘ï¼Œæ¯”è¾ƒé•¿ï¼š</p>
<div class="highlight"><pre class="chroma"><code class="language-Java" data-lang="Java">  <span class="kd">public</span> <span class="n">Object</span> <span class="nf">execute</span><span class="o">(</span><span class="n">SqlSession</span> <span class="n">sqlSession</span><span class="o">,</span> <span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">Object</span> <span class="n">result</span><span class="o">;</span>
    <span class="c1">//å¯ä»¥çœ‹åˆ°æ‰§è¡Œæ—¶å°±æ˜¯4ç§æƒ…å†µï¼Œinsert|update|delete|selectï¼Œåˆ†åˆ«è°ƒç”¨SqlSessionçš„4å¤§ç±»æ–¹æ³•
</span><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">SqlCommandType</span><span class="o">.</span><span class="na">INSERT</span> <span class="o">==</span> <span class="n">command</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">Object</span> <span class="n">param</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">convertArgsToSqlCommandParam</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">rowCountResult</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">param</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">SqlCommandType</span><span class="o">.</span><span class="na">UPDATE</span> <span class="o">==</span> <span class="n">command</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">Object</span> <span class="n">param</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">convertArgsToSqlCommandParam</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">rowCountResult</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">.</span><span class="na">update</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">param</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">SqlCommandType</span><span class="o">.</span><span class="na">DELETE</span> <span class="o">==</span> <span class="n">command</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
      <span class="n">Object</span> <span class="n">param</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">convertArgsToSqlCommandParam</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
      <span class="n">result</span> <span class="o">=</span> <span class="n">rowCountResult</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">param</span><span class="o">));</span>
    <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">SqlCommandType</span><span class="o">.</span><span class="na">SELECT</span> <span class="o">==</span> <span class="n">command</span><span class="o">.</span><span class="na">getType</span><span class="o">())</span> <span class="o">{</span>
      <span class="c1">// æˆ‘ä»¬æ‰§è¡Œçš„æ˜¯æŸ¥è¯¢ï¼Œç›´æ¥è·³åˆ°è¿™é‡Œ
</span><span class="c1"></span>      <span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">returnsVoid</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="n">method</span><span class="o">.</span><span class="na">hasResultHandler</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">// æ£€æŸ¥æ˜¯ä¸æ˜¯æ²¡æœ‰è¿”å›å€¼ä»¥åŠç»“æœå¤„ç†å™¨: æˆ‘ä»¬æ‰§è¡Œçš„æ˜¯æŸ¥è¯¢ï¼Œæ˜¯æœ‰è¿”å›å€¼çš„
</span><span class="c1"></span>        <span class="n">executeWithResultHandler</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
      <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">returnsMany</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">//å¦‚æœç»“æœæœ‰å¤šæ¡è®°å½•ï¼šæˆ‘ä»¬åªæŸ¥ä¸€æ¡
</span><span class="c1"></span>        <span class="n">result</span> <span class="o">=</span> <span class="n">executeForMany</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">returnsMap</span><span class="o">())</span> <span class="o">{</span>
        <span class="c1">//å¦‚æœç»“æœæ˜¯mapï¼šæˆ‘ä»¬æŸ¥çš„åªæ˜¯ä¸ªå¯¹è±¡
</span><span class="c1"></span>        <span class="n">result</span> <span class="o">=</span> <span class="n">executeForMap</span><span class="o">(</span><span class="n">sqlSession</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c1">//å¦åˆ™å°±æ˜¯ä¸€æ¡è®°å½•
</span><span class="c1"></span>        <span class="c1">// æˆ‘ä»¬ä»”ç»†åˆ†æè¿™ä¸ªconvertArgsToSqlCommandParamæ–¹æ³•
</span><span class="c1"></span>        <span class="n">Object</span> <span class="n">param</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="na">convertArgsToSqlCommandParam</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
        <span class="c1">// ä¹‹åæˆ‘ä»¬åˆå›åˆ°äº†SelectOneè¿™ä¸ªæ–¹æ³•ã€‚
</span><span class="c1"></span>        <span class="n">result</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectOne</span><span class="o">(</span><span class="n">command</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="n">param</span><span class="o">);</span>
      <span class="o">}</span>
    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">BindingException</span><span class="o">(</span><span class="s">&#34;Unknown execution method for: &#34;</span> <span class="o">+</span> <span class="n">command</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">result</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">method</span><span class="o">.</span><span class="na">getReturnType</span><span class="o">().</span><span class="na">isPrimitive</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">method</span><span class="o">.</span><span class="na">returnsVoid</span><span class="o">())</span> <span class="o">{</span>
      <span class="k">throw</span> <span class="k">new</span> <span class="n">BindingException</span><span class="o">(</span><span class="s">&#34;Mapper method &#39;&#34;</span> <span class="o">+</span> <span class="n">command</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span>
          <span class="o">+</span> <span class="s">&#34; attempted to return null from a method with a primitive return type (&#34;</span> <span class="o">+</span> <span class="n">method</span><span class="o">.</span><span class="na">getReturnType</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;).&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
  <span class="o">}</span>


  <span class="c1">// å°†å‚æ•°è½¬æ¢ä¸ºSQLå‘½ä»¤å‚æ•°
</span><span class="c1"></span>  <span class="kd">public</span> <span class="n">Object</span> <span class="nf">convertArgsToSqlCommandParam</span><span class="o">(</span><span class="n">Object</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">// è¿™é‡Œæœ‰ä¸€ä¸ªå‘ï¼š
</span><span class="c1"></span>      <span class="c1">// args æ˜¯Mapperæ–¹æ³•æ‰§è¡Œçš„å‚æ•°
</span><span class="c1"></span>      <span class="c1">// param æ˜¯ç¼–å†™çš„SQLè¯­å¥æ‰€éœ€è¦çš„å‘½ä»¤å‚æ•°
</span><span class="c1"></span>      <span class="c1">// å®ƒä»¬æœ‰ä»€ä¹ˆä¸åŒå‘¢ï¼š
</span><span class="c1"></span>      <span class="c1">// åœ¨MyBatisä¸­ä½ éœ€è¦ä½¿ç”¨åˆ†é¡µæ—¶å¯ä»¥ä¸æ˜¾å¼åœ¨SQLè¯­å¥ä¸­ä½¿ç”¨limitå‘½ä»¤
</span><span class="c1"></span>      <span class="c1">// ä½¿ç”¨RowBoundså¯¹è±¡ä½œä¸ºMapperçš„é¢å¤–å‚æ•°æ¥åšåˆ°æ•°æ®åˆ†é¡µ
</span><span class="c1"></span>      <span class="c1">// è¯¥å‚æ•°ä¸ç”¨åœ¨SQLè¯­å¥ä¸­æ˜¾å¼ä½¿ç”¨.
</span><span class="c1"></span>      <span class="kd">final</span> <span class="kt">int</span> <span class="n">paramCount</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="na">size</span><span class="o">();</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">args</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">paramCount</span> <span class="o">==</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//å¦‚æœæ²¡å‚æ•°
</span><span class="c1"></span>        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
      <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(!</span><span class="n">hasNamedParameters</span> <span class="o">&amp;&amp;</span> <span class="n">paramCount</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°
</span><span class="c1"></span>        <span class="k">return</span> <span class="n">args</span><span class="o">[</span><span class="n">params</span><span class="o">.</span><span class="na">keySet</span><span class="o">().</span><span class="na">iterator</span><span class="o">().</span><span class="na">next</span><span class="o">().</span><span class="na">intValue</span><span class="o">()];</span>
      <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
        <span class="c1">//å¦åˆ™ï¼Œè¿”å›ä¸€ä¸ªParamMapï¼Œä¿®æ”¹å‚æ•°åï¼Œå‚æ•°åå°±æ˜¯å…¶ä½ç½®
</span><span class="c1"></span>        <span class="kd">final</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">param</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ParamMap</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;();</span>
        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">.</span><span class="na">Entry</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span> <span class="n">entry</span> <span class="o">:</span> <span class="n">params</span><span class="o">.</span><span class="na">entrySet</span><span class="o">())</span> <span class="o">{</span>
          <span class="c1">//1.å…ˆåŠ ä¸€ä¸ª#{0},#{1},#{2}...å‚æ•°
</span><span class="c1"></span>          <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">entry</span><span class="o">.</span><span class="na">getValue</span><span class="o">(),</span> <span class="n">args</span><span class="o">[</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">().</span><span class="na">intValue</span><span class="o">()]);</span>
          <span class="c1">// issue #71, add param names as param1, param2...but ensure backward compatibility
</span><span class="c1"></span>          <span class="kd">final</span> <span class="n">String</span> <span class="n">genericParamName</span> <span class="o">=</span> <span class="s">&#34;param&#34;</span> <span class="o">+</span> <span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">1</span><span class="o">);</span>
          <span class="k">if</span> <span class="o">(!</span><span class="n">param</span><span class="o">.</span><span class="na">containsKey</span><span class="o">(</span><span class="n">genericParamName</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">//2.å†åŠ ä¸€ä¸ª#{param1},#{param2}...å‚æ•°
</span><span class="c1"></span>            <span class="c1">//ä½ å¯ä»¥ä¼ é€’å¤šä¸ªå‚æ•°ç»™ä¸€ä¸ªæ˜ å°„å™¨æ–¹æ³•ã€‚å¦‚æœä½ è¿™æ ·åšäº†,
</span><span class="c1"></span>            <span class="c1">//é»˜è®¤æƒ…å†µä¸‹å®ƒä»¬å°†ä¼šä»¥å®ƒä»¬åœ¨å‚æ•°åˆ—è¡¨ä¸­çš„ä½ç½®æ¥å‘½å,æ¯”å¦‚:#{param1},#{param2}ç­‰ã€‚
</span><span class="c1"></span>            <span class="c1">//å¦‚æœä½ æƒ³æ”¹å˜å‚æ•°çš„åç§°(åªåœ¨å¤šå‚æ•°æƒ…å†µä¸‹) ,é‚£ä¹ˆä½ å¯ä»¥åœ¨å‚æ•°ä¸Šä½¿ç”¨@Param(â€œparamNameâ€)æ³¨è§£ã€‚
</span><span class="c1"></span>            <span class="n">param</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">genericParamName</span><span class="o">,</span> <span class="n">args</span><span class="o">[</span><span class="n">entry</span><span class="o">.</span><span class="na">getKey</span><span class="o">()]);</span>
          <span class="o">}</span>
          <span class="n">i</span><span class="o">++;</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">param</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">}</span>

</code></pre></div><p>OK, æˆ‘åŸºæœ¬æƒ³è¯´çš„éƒ½è¯´å®Œäº†ã€‚åç»­å¯èƒ½ä¼šé¢å¤–è¡¥å……ä¸€äº›å†…å®¹ï¼Œä½†æ˜¯ä¸ä¼šåœ¨æœ¬æ–‡ä¸­ï¼Œä¼šå†™æ–°æ–‡ç« ã€‚</p>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="https://sdttttt.github.io/tags/java/">Java</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>

    
</article>

    <aside class="widget related-contents--wrapper">
    
    
</aside>

    
        
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.css">
  <script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.0/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>
    var gitalk = new Gitalk({
  clientID: '747ab8530477531c3d25',
  clientSecret: 'af2cc18e4c27998636a6a3c82af0064f38574170',
  repo: 'sdttttt.github.io',
  owner: 'sdttttt',
  admin: ['sdttttt'],
  id: location.pathname,      
  distractionFreeMode: true  
})

gitalk.render('gitalk-container')
</script>

    

    <footer class="site-footer">

</footer>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true" style="display:none">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
            </main>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"
    integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin="anonymous"></script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>
<link rel="stylesheet" href="/css/highlight/light.min.css" media="(prefers-color-scheme: light)">
<link rel="stylesheet" href="/css/highlight/dark.min.css" media="(prefers-color-scheme: dark)">

    </body>
</html>
