<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=theme-color content="dark"><title>Rails Development | SDTTTTT</title><link rel=stylesheet href=/sass/main.min.12754930aaca2409561861a9f13c52153f073ef96d63061a9a330c250f392fcb.css></head><body class=dark><nav class=navbar><div class=container><div class=flex><div><a class=brand href=/>SDTTTTT</a></div><div class=flex><button id=dark-mode-button></button></div></div></div></nav><main><div class=container><article><header class=article-header><div class=thumb><div><h1>Rails Development</h1><div class=post-meta><div>By on <time>January 01, 0001</time></div><div class=tags><a href=/tags/rails/>Rails</a></div></div></div></div></header></article><div class=article-post><h3 id=webpacker>Webpacker</h3><p>Rails 6版本开始依赖Webpacker，在运行之前必须先安装Webpacker这玩意。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>rails webpacker:install
</code></pre></td></tr></table></div></div><p>如果需要安装前端框架，请使用yarn来安装，这样部署的时候能享受到webpacker打包便利。</p><h3 id=production>production</h3><p>Rails 6 启动时需要一串Key作为加密的salt，key不能随意生成。
生成key时，请删除config下的credentials.enc.yml 和 master.key 文件。
然后运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>rails credentials:edit
</code></pre></td></tr></table></div></div><p>然后Rails访问静态资源，需要使用webpacker打包编译后的资产。
运行</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-shell data-lang=shell>rails assets:precompile
</code></pre></td></tr></table></div></div><p>Rails 6 在生产环境下认为你使用 Apache 和 Nginx 缓存编译后的静态资产。如果你不使用他们，需要</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-ruby data-lang=ruby><span class=c1># config/environments/production.rb</span>
<span class=n>config</span><span class=o>.</span><span class=n>public_file_server</span><span class=o>.</span><span class=n>enabled</span> <span class=o>=</span> <span class=kp>true</span>
</code></pre></td></tr></table></div></div><p>记住，打包之后的js以及css统一叫application.js/css 在view页面引用时需要引用application这个名字。其他的会报错</p></div></div><div class=container><nav class="flex container suggested"><a rel=prev href=/blog/ror_environment_config/ title="Previous post (older)"><span>Previous</span>
Rails ENV</a>
<a rel=next href=/blog/azure_pipelines/ title="Next post (newer)"><span>Next</span>
Azure Pipelines</a></nav></div></main></main><footer class="footer flex"><section class=container><nav class=footer-links></nav></section><script async src=/js/features.min.f77830aff4bfb7a756b9ef68388f40d2187cb0046d41790785074eb8cd054cc3.js data-enable-footnotes=true></script></footer></body></html>